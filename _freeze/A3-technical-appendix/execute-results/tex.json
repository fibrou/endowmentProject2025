{
  "hash": "fd3241cc5f1780dd4e776e410d95b6da",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Appendix C: Technical Details\"\n---\n\n\n\n## ESGtoolkit Implementation Notes\n\nThe ESGtoolkit package provides several advantages for endowment portfolio modeling:\n\n- **Flexible shock generation**: The `simshocks()` function supports various copula families including Gaussian, Student-t, and Archimedean classes, enabling practitioners to match the dependence structure to empirical patterns rather than imposing restrictive multivariate normality.\n\n- **Efficient simulation**: Antithetic variates reduce Monte Carlo error by generating complementary random draws that share negative correlation, effectively doubling sample information content without additional computation. This variance reduction technique is particularly valuable for estimating tail metrics where sampling variation is inherently high.\n\n- **Integrated framework**: Seamless combination of copula-based shocks with diffusion processes (GBM, CIR, Vasicek) enables holistic scenario generation where interest rates, equity returns, and other variables evolve jointly with realistic dependencies.\n\n- **Professional validation**: Built-in martingale tests and convergence diagnostics provide quality assurance for simulated scenarios, ensuring they satisfy no-arbitrage conditions and achieve adequate precision for downstream applications.\n\n## Vine Copula Methodology\n\nVine copulas decompose high-dimensional dependence structures into bivariate copulas organized in a tree structure, allowing for:\n\n### Asymmetric Dependencies\n\nDifferent asset pairs can exhibit different types of dependence (symmetric, asymmetric, tail-heavy, tail-independent) rather than imposing a single correlation structure across all pairs as multivariate normal or t-distributions require.\n\n### Flexible Tail Behaviors\n\nClayton copulas capture lower tail dependence (co-crash risk), Gumbel copulas capture upper tail dependence (co-boom risk), and Student-t copulas capture symmetric tail dependence. This flexibility better reflects empirical observations where some assets crash together but rally independently, or vice versa.\n\n### More Accurate Extreme Event Modeling\n\nBy explicitly modeling tail dependencies through appropriate copula families, vine copulas generate scenarios where joint extremes occur with frequencies matching actual market behavior rather than the underestimation typical of Gaussian assumptions.\n\n### Better Capture of Contagion Effects\n\nThe hierarchical vine structure naturally represents contagion and spillover effects where dependencies strengthen during market stress, propagating through the tree structure to generate realistic crisis scenarios.\n\n## Mathematical Foundations\n\n### Sklar's Theorem\n\nAny multivariate cumulative distribution function $F$ can be decomposed as:\n\n$F(x_1, \\ldots, x_d) = C(F_1(x_1), \\ldots, F_d(x_d))$\n\nwhere $C$ is a copula function—a multivariate distribution on $[0,1]^d$ with uniform marginals—and $F_i$ are the marginal distribution functions.\n\n### Vine Copula Density Decomposition\n\nThe joint density can be decomposed through conditional distributions:\n\n$f(x_1, \\ldots, x_d) = \\prod_{i=1}^{d} f_i(x_i) \\cdot \\prod_{j=1}^{d-1}\\prod_{e \\in E_j} c_{e|D(e)}$\n\nwhere $c_{e|D(e)}$ represents pair-copula densities conditional on sets $D(e)$ determined by the vine structure, and $E_j$ denotes edges in tree $j$.\n\n### Tail Dependence Coefficients\n\nLower tail dependence coefficient for bivariate copula $C$:\n\n$$\\lambda_L = \\lim_{u \\to 0^+} P(U_2 \\leq u | U_1 \\leq u) = \\lim_{u \\to 0^+} \\frac{C(u, u)}{u}$$\n\nUpper tail dependence coefficient:\n\n$\\lambda_U = \\lim_{u \\to 1^-} P(U_2 > u | U_1 > u) = \\lim_{u \\to 1^-} \\frac{1 - 2u + C(u, u)}{1 - u}$\n\nFor independence, $\\lambda_L = \\lambda_U = 0$. For perfect tail dependence, $\\lambda_L = \\lambda_U = 1$.\n\n## Copula Family Characteristics\n\n### Gaussian Copula\n\n$$C(u_1, u_2; \\rho) = \\Phi_\\rho(\\Phi^{-1}(u_1), \\Phi^{-1}(u_2))$$\n\n- Symmetric dependence\n- No tail dependence ($\\lambda_L = \\lambda_U = 0$)\n- Parameter: $\\rho \\in (-1, 1)$ (linear correlation)\n\n### Student-t Copula\n\n$$C(u_1, u_2; \\rho, \\nu) = t_{\\rho,\\nu}(t_\\nu^{-1}(u_1), t_\\nu^{-1}(u_2))$$\n\n- Symmetric dependence with tail dependence\n- Both upper and lower tail dependence\n- Parameters: $\\rho \\in (-1, 1)$, $\\nu > 0$ (degrees of freedom)\n\n### Clayton Copula\n\n$$C(u_1, u_2; \\theta) = (u_1^{-\\theta} + u_2^{-\\theta} - 1)^{-1/\\theta}$$\n\n- Asymmetric with lower tail dependence\n- $\\lambda_L = 2^{-1/\\theta}$, $\\lambda_U = 0$\n- Parameter: $\\theta > 0$\n\n## Gumbel Copula\n\n$$C(u_1, u_2; \\theta) = \\exp\\{-[(-\\ln u_1)^\\theta + (-\\ln u_2)^\\theta]^{1/\\theta}\\}$$\n\n- Asymmetric with upper tail dependence\n- $\\lambda_L = 0$, $\\lambda_U = 2 - 2^{1/\\theta}$\n- Parameter: $\\theta \\geq 1$\n\n## Frank Copula\n\n$$C(u_1, u_2; \\theta) = -\\frac{1}{\\theta}\\ln\\left(1 + \\frac{(e^{-\\theta u_1} - 1)(e^{-\\theta u_2} - 1)}{e^{-\\theta} - 1}\\right)$$\n\n- Symmetric without tail dependence\n- $\\lambda_L = \\lambda_U = 0$\n- Parameter: $\\theta \\in \\mathbb{R} \\setminus \\{0\\}$\n\n## Joe Copula\n\n$$C(u_1, u_2; \\theta) = 1 - [(1-u_1)^\\theta + (1-u_2)^\\theta - (1-u_1)^\\theta(1-u_2)^\\theta]^{1/\\theta}$$\n\n- Asymmetric with upper tail dependence\n- $\\lambda_U = 2 - 2^{1/\\theta}$, $\\lambda_L = 0$\n- Parameter: $\\theta \\geq 1$\n\n# Software Implementation Details\n\n## Package Versions\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\nTable: Key Package Versions Used\n\n|                     |Package              |Version   |\n|:--------------------|:--------------------|:---------|\n|rvinecopulib         |rvinecopulib         |0.7.3.1.0 |\n|VineCopula           |VineCopula           |2.6.1     |\n|fPortfolio           |fPortfolio           |4023.84   |\n|esgtoolkit           |esgtoolkit           |1.8.0     |\n|PerformanceAnalytics |PerformanceAnalytics |2.0.8     |\n\n\n:::\n:::\n\n\n## Computational Environment\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version: R version 4.5.1 (2025-06-13) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPlatform: x86_64-pc-linux-gnu \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRunning under: Linux 6.8.0-85-generic \n```\n\n\n:::\n:::\n\n\n# Convergence Analysis\n\n## Monte Carlo Standard Errors\n\nFor a quantity $\\theta$ estimated from $N$ simulation paths, the Monte Carlo standard error is:\n\n$$SE_{MC} = \\frac{\\sigma}{\\sqrt{N}}$$\n\nwhere $\\sigma$ is the standard deviation of the quantity across simulation paths. Achieving a standard error of 0.001 for a quantity with $\\sigma = 0.10$ requires:\n\n$$N = \\left(\\frac{0.10}{0.001}\\right)^2 = 10,000 \\text{ paths}$$\n\n## Variance Reduction\n\nAntithetic variates generate complementary paths $(Z, -Z)$ where $Z$ is a standard normal shock. For a function $f$ with monotonic behavior:\n\n$$Var\\left[\\frac{f(Z) + f(-Z)}{2}\\right] \\leq Var[f(Z)]$$\n\nTypical variance reduction factors range from 1.5× to 2.5× depending on function curvature.\n\n# Data Quality Checks\n\n## Missing Value Summary\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\nTable: Missing Value Summary\n\n|Variable          | Missing_Count| Missing_Pct|\n|:-----------------|-------------:|-----------:|\n|caldt             |             0|           0|\n|tradedUniPortRets |             0|           0|\n|sp500Return       |             0|           0|\n|tBillReturn       |             0|           0|\n|hfRet             |             0|           0|\n|peRet             |             0|           0|\n|vcRet             |             0|           0|\n|reRet             |             0|           0|\n|comRet            |             0|           0|\n\n\n:::\n:::\n\n\n## Outlier Detection\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\nTable: Outlier Summary (>5 SD from mean)\n\n|Asset             | N_Outliers| Pct_Outliers|\n|:-----------------|----------:|------------:|\n|tradedUniPortRets |         10|    0.2268088|\n|sp500Return       |         22|    0.4989794|\n|hfRet             |         21|    0.4762985|\n|peRet             |         15|    0.3402132|\n|vcRet             |         10|    0.2268088|\n|reRet             |         25|    0.5670220|\n|comRet            |          4|    0.0907235|\n\n\n:::\n:::\n\n\n# Limitations and Future Extensions\n\n## Current Limitations\n\n1. **Static Parameters**: Copula parameters are estimated over the full sample period, ignoring potential time-variation or regime changes.\n\n2. **Truncation**: We use full vine structures without truncation, which may overfit in high dimensions.\n\n3. **Illiquidity**: Alternative asset valuations may be smoothed, understating true volatility and overstating diversification benefits.\n\n4. **Fees**: Optimization abstracts from management fees, performance fees, and transaction costs that materially impact net returns.\n\n## Potential Extensions\n\n1. **Dynamic Copulas**: Implement DCC-GARCH or time-varying vine structures to capture evolving dependencies.\n\n2. **Regime-Switching**: Model distinct normal and crisis regimes with different copula parameters.\n\n3. **Liquidity Constraints**: Add explicit constraints for capital call obligations and spending requirements.\n\n4. **Robust Optimization**: Incorporate parameter uncertainty through Bayesian methods or worst-case optimization.\n\n5. **Factor Models**: Decompose returns into systematic factors and idiosyncratic components.\n\n---\n\n*Technical appendix compiled 2025-10-05*",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}